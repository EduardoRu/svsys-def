"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2898],{8505:(I,E,a)=>{a.d(E,{Z:()=>_});var m=a(467),f=a(177),i=a(4341),h=a(305),c=a(7604),e=a(3953),b=a(6761),l=a(5217);let _=(()=>{var g;class o{constructor(s,d,P){this.router=s,this.auth=d,this.storageService=P}ngOnInit(){setTimeout(()=>{this.getUser()},1e3)}getUser(){var s=this;return(0,m.A)(function*(){const d=yield s.storageService.getValue("usuario");s.userRole=d.role})()}rToControlInformacion(){this.router.navigate(["/control-informacion"],{replaceUrl:!0})}rToAdministracionCuentas(){this.router.navigate(["/administracion-cuentas"],{replaceUrl:!0})}rToReportes(){this.router.navigate(["/reportes"],{replaceUrl:!0})}rToHistoriaReportes(){this.router.navigate(["/historia-reportes"],{replaceUrl:!0})}rToPanelControl(){this.router.navigate(["/panel-control"],{replaceUrl:!0})}rToMiPerfil(){this.router.navigate(["/mi-perfil"],{replaceUrl:!0})}rToVehEqui(){this.router.navigate(["/vehi-equi"],{replaceUrl:!0})}rToCertificados(){this.router.navigate(["/certificados"],{replaceUrl:!0})}logout(){this.auth.logout(),this.router.navigate(["/login"],{replaceUrl:!0})}}return(g=o).\u0275fac=function(s){return new(s||g)(e.rXU(h.Ix),e.rXU(b.u),e.rXU(l.n))},g.\u0275cmp=e.VBU({type:g,selectors:[["app-menu"]],inputs:{titulo:"titulo"},standalone:!0,features:[e.aNF],decls:42,vars:1,consts:[["contentId","main-content","mode","ios"],[2,"--background","#ffff"],[1,"text-center","pt-5",2,"background-color","#ffff"],["src","/assets/logo_bg1.png","alt","","srcset","",2,"max-width","50%","background-color","#ffff"],[1,"mt-3",2,"color","white"],[2,"background","#ffff"],["lines","none","slot","header","color","light","button","",3,"click"],["lines","none","slot","header","color","light","button","",1,"pt-1",3,"click"],[2,"background-color","#ffff"],[1,"d-grid","gap-2"],["type","button","id","cerrar-sesion",1,"btn","btn-danger",3,"click"],["id","main-content"],[2,"--background","#211F20","color","white"],["slot","start"],["autoHide","false"],[2,"text-align","center"],["slot","end"],["size","large",3,"click"],["slot","icon-only","name","person-circle-outline"]],template:function(s,d){1&s&&(e.j41(0,"div")(1,"ion-menu",0)(2,"ion-content",1)(3,"div",2),e.nrm(4,"img",3),e.j41(5,"h5",4)(6,"b"),e.EFF(7,"Administrador"),e.k0s()()(),e.j41(8,"ion-list",5)(9,"ion-item",6),e.bIt("click",function(){return d.rToPanelControl()}),e.j41(10,"ion-label"),e.EFF(11," Panel de Control"),e.k0s()(),e.j41(12,"ion-item",7),e.bIt("click",function(){return d.rToReportes()}),e.j41(13,"ion-label"),e.EFF(14,"Reportes"),e.k0s()(),e.j41(15,"ion-item",7),e.bIt("click",function(){return d.rToCertificados()}),e.j41(16,"ion-label"),e.EFF(17,"Certificados"),e.k0s()(),e.j41(18,"ion-item",7),e.bIt("click",function(){return d.rToControlInformacion()}),e.j41(19,"ion-label"),e.EFF(20,"Control de Informaci\xf3n"),e.k0s()(),e.j41(21,"ion-item",7),e.bIt("click",function(){return d.rToVehEqui()}),e.j41(22,"ion-label"),e.EFF(23,"Vehiculos y equipos"),e.k0s()(),e.j41(24,"ion-item",7),e.bIt("click",function(){return d.rToAdministracionCuentas()}),e.j41(25,"ion-label"),e.EFF(26,"Administraci\xf3n de personal"),e.k0s()()()(),e.j41(27,"ion-footer",8)(28,"div",9)(29,"button",10),e.bIt("click",function(){return d.logout()}),e.EFF(30,"Cerrar Sesi\xf3n"),e.k0s()()()(),e.j41(31,"ion-header",11)(32,"ion-toolbar",12)(33,"ion-buttons",13),e.nrm(34,"ion-menu-button",14),e.k0s(),e.j41(35,"ion-text",15)(36,"h4")(37,"b"),e.EFF(38),e.k0s()()(),e.j41(39,"ion-buttons",16)(40,"ion-button",17),e.bIt("click",function(){return d.rToMiPerfil()}),e.nrm(41,"ion-icon",18),e.k0s()()()()()),2&s&&(e.R7$(38),e.JRh(d.titulo))},dependencies:[c.bv,c.Jm,c.QW,c.W9,c.M0,c.eU,c.iq,c.uz,c.he,c.nf,c.oS,c.MC,c.IO,c.ai,f.MD,i.YN,i.X1,h.iI],styles:['@charset "UTF-8";ion-menu[_ngcontent-%COMP%]::part(container){border-radius:0 20px 20px 0;--background: #757374}ion-item[_ngcontent-%COMP%]{--background-color: #c0c0c0;--color: #c0c0c0;--border-color: #c0c0c0;--border-width: 2px;--detail-icon-color: white;--detail-icon-opacity: 1;--detail-icon-font-size: 20px}.cerrar-sesion-toolbar[_ngcontent-%COMP%]{--background: #d6282e;transition:background-color .4s ease;cursor:pointer}.cerrar-sesion-toolbar[_ngcontent-%COMP%]:hover{--background: rgba(151, 43, 43, .692)}#cerrar-sesion[_ngcontent-%COMP%]{color:#fff;transition:color .3s ease}']}),o})()},2898:(I,E,a)=>{a.r(E),a.d(E,{CertificadosPageModule:()=>M});var m=a(177),f=a(4341),i=a(7604),h=a(305),c=a(467),e=a(3953),b=a(9967),l=a(3273),_=a(6335);let g=(()=>{var n;class p{constructor(r,t){this.firestore=r,this.auth=t}getCertificadoProgramada(){const r=(0,b.rJ)(this.firestore,"certificados");return(0,b.xs)(r,{idField:"id"})}getCertificadoById(r){const t=(0,b.H9)(this.firestore,`certificados/${r}`);return(0,b.Bg)(t,{idField:"id"})}deleteCertificado(r){const t=(0,b.H9)(this.firestore,`certificados/${r}`);return(0,l.kd)(t)}addCertificado(r){return(0,l.gS)((0,b.rJ)(this.firestore,"certificados"),r)}updateCertificado(r){const t=(0,b.H9)(this.firestore,`certificados/${r.id}`);return(0,b.mZ)(t,{certificado:r.certificado})}}return(n=p).\u0275fac=function(r){return new(r||n)(e.KVO(b._7),e.KVO(_.Nj))},n.\u0275prov=e.jDH({token:n,factory:n.\u0275fac,providedIn:"root"}),p})(),o=(()=>{var n;class p{constructor(r,t,v,y,k){this.fb=r,this.modalController=t,this.alertController=v,this.loadingController=y,this.certificadosService=k}ngOnInit(){this.certificado=this.fb.group({rIni:["",f.k0.required],rFin:["",f.k0.required]})}cancel(){this.modalController.dismiss()}guardarCer(){var r=this;return(0,c.A)(function*(){const t=r.certificado.value.rIni,v=r.certificado.value.rFin;if(!t||!v)return void r.showAlert("Error","Por favor, ingresa ambos rangos.");const y=t.slice(0,-6);if(y!==v.slice(0,-6))return void r.showAlert("Error","Los rangos deben tener el mismo prefijo.");const U=parseInt(t.slice(-6)),T=parseInt(v.slice(-6));if(isNaN(U)||isNaN(T)||U>T)return void r.showAlert("Error","Rango inv\xe1lido. Aseg\xfarate de que los n\xfameros sean correctos.");const R=[];for(let A=U;A<=T;A++)R.push(`${y}${A.toString().padStart(6,"0")}`);const O=yield r.loadingController.create({message:"Guardando certificados..."});yield O.present();try{for(const A of R)yield r.certificadosService.addCertificado({certificado:A});yield O.dismiss(),r.showAlert("\xc9xito","Certificados guardados exitosamente."),r.modalController.dismiss()}catch(A){yield O.dismiss(),r.showAlert("Error","Ocurri\xf3 un error al guardar los certificados."),console.error(A)}})()}showAlert(r,t){var v=this;return(0,c.A)(function*(){yield(yield v.alertController.create({header:r,message:t,buttons:["OK"]})).present()})()}}return(n=p).\u0275fac=function(r){return new(r||n)(e.rXU(f.ok),e.rXU(i.W3),e.rXU(i.hG),e.rXU(i.Xi),e.rXU(g))},n.\u0275cmp=e.VBU({type:n,selectors:[["app-agregar-cer"]],standalone:!0,features:[e.aNF],decls:20,vars:3,consts:[[2,"--background","#757374","color","white"],["slot","end"],[3,"click"],["slot","icon-only","name","close-outline"],[3,"ngSubmit","formGroup"],[1,"row"],[1,"col-md-6"],["label","Rango inicial","labelPlacement","floating","fill","outline","placeholder","Placa del vehiculo","formControlName","rIni",1,"p-2",3,"autoGrow"],["label","Rango final","labelPlacement","floating","fill","outline","placeholder","Placa del vehiculo","formControlName","rFin",1,"p-2",3,"autoGrow"],["type","submit","expand","block","color","primary"],["type","button","expand","block","color","danger",3,"click"]],template:function(r,t){1&r&&(e.j41(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title"),e.EFF(3," Agrega un nuevo automovil - Placa "),e.k0s(),e.j41(4,"ion-buttons",1)(5,"ion-button",2),e.bIt("click",function(){return t.cancel()}),e.nrm(6,"ion-icon",3),e.k0s()()()(),e.j41(7,"ion-content")(8,"div")(9,"form",4),e.bIt("ngSubmit",function(){return t.guardarCer()}),e.j41(10,"div",5)(11,"div",6),e.nrm(12,"ion-textarea",7),e.k0s(),e.j41(13,"div",6),e.nrm(14,"ion-textarea",8),e.k0s()(),e.j41(15,"ion-button",9),e.EFF(16,"Agregar"),e.k0s(),e.nrm(17,"hr"),e.j41(18,"ion-button",10),e.bIt("click",function(){return t.cancel()}),e.EFF(19,"Cancelar"),e.k0s()()()()),2&r&&(e.R7$(9),e.Y8G("formGroup",t.certificado),e.R7$(3),e.Y8G("autoGrow",!0),e.R7$(2),e.Y8G("autoGrow",!0))},dependencies:[m.MD,i.bv,i.Jm,i.QW,i.W9,i.eU,i.iq,i.nc,i.BC,i.ai,i.Gw,f.YN,f.qT,f.BC,f.cb,f.X1,f.j4,f.JD]}),p})();var u=a(8505);function s(n,p){if(1&n&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td")(6,"ion-button",21),e.nrm(7,"ion-icon",22),e.k0s()()()),2&n){const C=p.$implicit,r=p.index,t=e.XpG();e.R7$(2),e.JRh((t.paginaActual-1)*t.itemsPorPagina+r+1),e.R7$(2),e.JRh(C.certificado)}}const P=[{path:"",component:(()=>{var n;class p{constructor(r,t,v,y,k,U){this.certificadosService=r,this.modalController=t,this.toastController=v,this.alertController=y,this.loadingController=k,this.formBuilder=U,this.certificados=[],this.certificadosMostrados=[],this.paginaActual=1,this.itemsPorPagina=10}ngOnInit(){this.getCertificados()}getCertificados(){var r=this;return(0,c.A)(function*(){const t=yield r.loadingController.create({message:"Cargando certificados..."});yield t.present(),r.certificadosService.getCertificadoProgramada().subscribe({next:v=>{r.certificados=v,r.paginarCertificados(),t.dismiss()},error:v=>{console.error(v),t.dismiss()}})})()}paginarCertificados(){const r=(this.paginaActual-1)*this.itemsPorPagina;this.certificadosMostrados=this.certificados.slice(r,r+this.itemsPorPagina)}siguientePagina(){this.paginaActual*this.itemsPorPagina<this.certificados.length&&(this.paginaActual++,this.paginarCertificados())}paginaAnterior(){this.paginaActual>1&&(this.paginaActual--,this.paginarCertificados())}agregarCertificado(){var r=this;return(0,c.A)(function*(){const t=yield r.modalController.create({component:o,cssClass:"modalAutos"});t.onDidDismiss().then(()=>{r.getCertificados()}),yield t.present()})()}}return(n=p).\u0275fac=function(r){return new(r||n)(e.rXU(g),e.rXU(i.W3),e.rXU(i.K_),e.rXU(i.hG),e.rXU(i.Xi),e.rXU(f.ok))},n.\u0275cmp=e.VBU({type:n,selectors:[["app-certificados"]],decls:43,vars:6,consts:[["titulo","Certificados / Hologramas"],[3,"fullscreen"],[1,"row"],[1,"col-md-6"],[1,"custom-card-height-usuarios",2,"border-radius","15px"],[2,"background-color","#211F20"],[1,"text-center",2,"color","white"],["placeholder","Buscar certificado","inputmode","text","type","text","showCancelButton","always",3,"debounce"],[1,"table","table-striped","text-center"],[4,"ngFor","ngForOf"],[1,"d-flex","justify-content-between","mt-2"],["color","primary","size","small",3,"click","disabled"],["slot","start","name","arrow-back-circle-outline"],["slot","end","name","arrow-forward-circle-outline"],["placeholder","Buscar usuario","inputmode","text","type","text","showCancelButton","always",3,"debounce"],["slot","fixed","vertical","bottom","horizontal","end","color","primary"],["color","primary"],["name","chevron-up-circle"],["side","top"],["color","primary",3,"click"],["name","add-circle-outline"],["fill","clear","size","small","color","danger"],["name","trash-outline"]],template:function(r,t){1&r&&(e.nrm(0,"app-menu",0),e.j41(1,"ion-content",1)(2,"div",2)(3,"div",3)(4,"ion-card",4)(5,"ion-card-header",5)(6,"ion-card-title",6),e.EFF(7," Hologramas disponibles "),e.k0s(),e.j41(8,"ion-card-subtitle"),e.nrm(9,"ion-searchbar",7),e.k0s()(),e.j41(10,"ion-card-content")(11,"table",8)(12,"thead")(13,"tr")(14,"th"),e.EFF(15,"#"),e.k0s(),e.j41(16,"th"),e.EFF(17,"Certificado"),e.k0s(),e.j41(18,"th"),e.EFF(19,"Acciones"),e.k0s()()(),e.j41(20,"tbody"),e.DNE(21,s,8,2,"tr",9),e.k0s()(),e.j41(22,"div",10)(23,"ion-button",11),e.bIt("click",function(){return t.paginaAnterior()}),e.nrm(24,"ion-icon",12),e.EFF(25," Anterior "),e.k0s(),e.j41(26,"ion-button",11),e.bIt("click",function(){return t.siguientePagina()}),e.EFF(27," Siguiente "),e.nrm(28,"ion-icon",13),e.k0s()()()()(),e.j41(29,"div",3)(30,"ion-card",4)(31,"ion-card-header",5)(32,"ion-card-title",6),e.EFF(33," Asignaci\xf3n de hologramas a los usuarios "),e.k0s(),e.j41(34,"ion-card-subtitle"),e.nrm(35,"ion-searchbar",14),e.k0s()(),e.nrm(36,"ion-card-content"),e.k0s()()(),e.j41(37,"ion-fab",15)(38,"ion-fab-button",16),e.nrm(39,"ion-icon",17),e.k0s(),e.j41(40,"ion-fab-list",18)(41,"ion-fab-button",19),e.bIt("click",function(){return t.agregarCertificado()}),e.nrm(42,"ion-icon",20),e.k0s()()()()),2&r&&(e.R7$(),e.Y8G("fullscreen",!0),e.R7$(8),e.Y8G("debounce",250),e.R7$(12),e.Y8G("ngForOf",t.certificadosMostrados),e.R7$(2),e.Y8G("disabled",1===t.paginaActual),e.R7$(3),e.Y8G("disabled",t.paginaActual*t.itemsPorPagina>=t.certificados.length),e.R7$(9),e.Y8G("debounce",250))},dependencies:[m.Sq,i.Jm,i.b_,i.I9,i.ME,i.HW,i.tN,i.W9,i.Q8,i.YW,i.OL,i.iq,i.S1,i.Gw,u.Z]}),p})()}];let F=(()=>{var n;class p{}return(n=p).\u0275fac=function(r){return new(r||n)},n.\u0275mod=e.$C({type:n}),n.\u0275inj=e.G2t({imports:[h.iI.forChild(P),h.iI]}),p})(),M=(()=>{var n;class p{}return(n=p).\u0275fac=function(r){return new(r||n)},n.\u0275mod=e.$C({type:n}),n.\u0275inj=e.G2t({imports:[m.MD,f.YN,i.bv,F,u.Z]}),p})()},6761:(I,E,a)=>{a.d(E,{u:()=>b});var m=a(467),f=a(6335),i=a(6114),h=a(9967),c=a(3953),e=a(1626);let b=(()=>{var l;class _{constructor(o,u,s){this.auth=o,this.firestore=u,this.http=s}register({usuario:o,email:u,password:s,role:d,autos:P,herramientas:F,documentos:M,reportes:n}){var p=this;return(0,m.A)(function*(){try{const C=yield(0,f.eJ)(p.auth,u,s),t=(0,h.H9)(p.firestore,`users/${C.user.uid}`);return yield(0,h.BN)(t,{usuario:o,email:u,role:d,autos:P,herramientas:F,documentos:M,reportes:n}),C}catch{return null}})()}login({email:o,password:u}){var s=this;return(0,m.A)(function*(){try{return yield(0,f.x9)(s.auth,o,u)}catch{return null}})()}getUsers(){const o=(0,h.rJ)(this.firestore,"users");return(0,h.xs)(o,{idField:"id"})}getUser(){var o=this;return(0,m.A)(function*(){const u=yield o.auth.currentUser,s=(0,h.H9)(o.firestore,`users/${u.uid}`);return(0,h.Bg)(s,{idField:"id"})})()}getUserRole(){var o=this;return(0,m.A)(function*(){const u=yield o.auth.currentUser;if(u){const s=(0,h.H9)(o.firestore,`users/${u.uid}`),d=(0,h.Bg)(s,{idField:"id"});return(null==d?void 0:d.role)||"user"}return"guest"})()}logout(){return(0,f.CI)(this.auth)}deleteUser(o){var u=this;return(0,m.A)(function*(){try{const s=u.auth.currentUser;if(s){const d=i.IX.credential(s.email,o);yield(0,f.kZ)(s,d),yield(0,f.hG)(s),console.log("Usuario eliminado con \xe9xito")}else console.error("No hay usuario autenticado")}catch(s){console.error("Error al eliminar el usuario:",s)}})()}updateUser(o){var u=this;return(0,m.A)(function*(){try{const s=(0,h.H9)(u.firestore,`users/${o.id}`);return(0,h.mZ)(s,{usuario:o.usuario,email:o.email,role:o.role,autos:o.autos,herramientas:o.herramientas})}catch(s){return console.error("Error al actualizar la informaci\xf3n del usuario:",s),{success:!1,error:s}}})()}updateUserFields(o,u,s){var d=this;return(0,m.A)(function*(){const P=(0,h.H9)(d.firestore,"users",o),F={usuario:u,role:s};try{yield(0,h.mZ)(P,F)}catch(M){console.error("Error al actualizar usuario y role: ",M)}})()}}return(l=_).\u0275fac=function(o){return new(o||l)(c.KVO(f.Nj),c.KVO(h._7),c.KVO(e.Qq))},l.\u0275prov=c.jDH({token:l,factory:l.\u0275fac,providedIn:"root"}),_})()},5217:(I,E,a)=>{a.d(E,{n:()=>h});var m=a(467),f=a(3953),i=a(369);let h=(()=>{var c;class e{constructor(l){this.storage=l,this._storage=null,this.init()}init(){var l=this;return(0,m.A)(function*(){const _=yield l.storage.create();l._storage=_})()}addValue(l,_){var g=this;return(0,m.A)(function*(){var o;yield null===(o=g._storage)||void 0===o?void 0:o.set(l,_)})()}getValue(l){var _=this;return(0,m.A)(function*(){var g;return yield null===(g=_._storage)||void 0===g?void 0:g.get(l)})()}updateValue(l,_){var g=this;return(0,m.A)(function*(){var o,u;(yield null===(o=g._storage)||void 0===o?void 0:o.get(l))&&(yield null===(u=g._storage)||void 0===u?void 0:u.set(l,_))})()}removeValue(l){var _=this;return(0,m.A)(function*(){var g;yield null===(g=_._storage)||void 0===g?void 0:g.remove(l)})()}getAllValues(){var l=this;return(0,m.A)(function*(){var _;return yield null===(_=l._storage)||void 0===_?void 0:_.keys()})()}clearTempValues(){var l=this;return(0,m.A)(function*(){var _;yield null===(_=l._storage)||void 0===_?void 0:_.clear()})()}}return(c=e).\u0275fac=function(l){return new(l||c)(f.KVO(i.w))},c.\u0275prov=f.jDH({token:c,factory:c.\u0275fac,providedIn:"root"}),e})()}}]);